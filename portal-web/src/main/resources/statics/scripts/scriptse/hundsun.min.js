
var Hundsun={getFileExtension:function(fileName){var returnV='';var tmps=fileName.split('.');if(tmps.length>1){returnV='.'+tmps[tmps.length-1];}return returnV;},getEvent:function(){var returnO=null;if(window.event){returnO=window.event;}else{var func=Hundsun.getEvent.caller;while(func!=null){var arg0=func.arguments[0];if(arg0&&(arg0.constructor==KeyboardEvent||arg0.constructor==MouseEvent)){returnO=arg0;break;}func=func.caller;}}return returnO;},keyEnterSubmit:function(fn){var e=Hundsun.getEvent();if(e.keyCode==13){fn.call();}},formatDate:function(date,format){if(!format){format='Y-m-d';}var returnV;if(date!=null&&date!=''){var time=parseInt(date.time);var dateO=new Date(time);returnV=dateO.format(format);}return returnV;},getFormatDateFunction:function(format){return function(v){return Hundsun.formatDate(v,format);}},getFileInputValue:function(fileInput){var returnO={};if(fileInput){if(jQuery.browser.msie){fileInput.select();var filePath=document.selection.createRange().text;returnO={fileName:filePath,filePath:filePath};}else if(jQuery.browser.mozilla){if(fileInput.files){var fileName,filePath;var f=fileInput.files[0];if(f){fileName=f.name;filePath=window.URL.createObjectURL(f);returnO={fileName:fileName,filePath:filePath};}}else{filePath=fileInput.value;returnO={fileName:filePath,filePath:filePath};}}else{filePath=fileInput.value;returnO={fileName:filePath,filePath:filePath};}}return returnO;},setImageSrc:function(){},showImageWithMaxSize:function(imgJQueryObject,src,maxSize){imgJQueryObject.attr('style','');imgJQueryObject.attr('src',src);imgJQueryObject.hide();var scale;setTimeout(function(){var w=imgJQueryObject.outerWidth();var h=imgJQueryObject.outerHeight();var w1,h1;if(w>=h){w1=maxSize;scale=w/w1;h1=h/scale;}else{h1=maxSize;scale=h/h1;w1=w/scale;}imgJQueryObject.width(w1);imgJQueryObject.height(h1);imgJQueryObject.show(200);},200);return scale;},formatNumber:function(value,pos){if(pos==null||pos==undefined){pos=2}var returnV=0;if(value){returnV=parseFloat(value).toFixed(pos);returnV=parseFloat(returnV).toLocaleString();}return returnV;},getformatNumberHandler:function(pos){return function(v){return Hundsun.formatNumber(v,pos);}},formatDate:function(date,format){var returnV='';if(date){if(!format){format='Y-m-d H:i:s';}var time;if(date.time){time=parseInt(date.time);}else{time=date;}var dateO=new Date(time);returnV=dateO.format(format);}return returnV;},getFormatDateFunction:function(format){return function(v){return Hundsun.formatDate(v,format);}}};Hundsun.StringUtil={trim:function(str){if(str==undefined||str==null)return'';return str.replace(/(^\s*)|(\s*$)/g,'');},removeHtml:function(html){var _val=$("<div>"+html+"</div>").text();return _val;},substring:function(str,start,length){var length=str.length>200?200:str.length;str=str.substring(start,length);return str;},convertBlankAndEnterToBrAndNbsp:function(str){if(str){return str.replace(/\n/g,'<br/>').replace(/  /g,'&nbsp;&nbsp;');}else{return'';}}};Hundsun.PopUtil={loading:function(parameter){if(!parameter){parameter={}}if(!parameter.msg){parameter.msg='系统正在处理,请稍候......'}if(!parameter.width){parameter.width='250'}return new Boxy('<div style="width:'+parameter.width+'px;"><div class="common_loading">'+parameter.msg+'</div></div>',{modal:true});},alert:function(parameter){if(!parameter){parameter={}}if(!parameter.msg){parameter.msg='操作成功!'}if(!parameter.width){parameter.width=380}if(!parameter.timeout){parameter.timeout=700}if(!parameter.type){parameter.type='success'}var renderHtml='<div class="common_msg2" >'+'<span class="icons '+parameter.type+'"></span><span class="text '+parameter.type+'">'+parameter.msg+'</span></div>';if(parameter.autohide){var b=new Boxy('<div style="width:'+parameter.width+'px;">'+renderHtml+'</div>',{modal:true,show:false});b.show(400);setTimeout(function(){b.hide(parameter.callback);},parameter.timeout+400);}else{Boxy.alert(renderHtml,function(){if(parameter.callback){parameter.callback.call();}},{w:parameter.width})}},confirm:function(parameter,fn){if(!parameter){parameter={}}if(!parameter.width){parameter.width='380'}var renderHtml='<div class="common_msg2">'+'<span class="icons icon_question"></span><span class="text">'+parameter.msg+'</span></div>';Boxy.confirm(renderHtml,fn,{w:parameter.width})}};Hundsun.Window=function(contextBox,params){if(!params){params={};}params.modal=true;params.unloadOnHide=false;params.title=params.title?params.title:'弹出窗口';var winObj=$('#'+contextBox);var html=winObj.html();winObj.remove();this.win=new Boxy(html,params);};Hundsun.Window.prototype={open:function(){this.win.show(300);},hide:function(fn){this.win.hide();},setTitle:function(title){this.win.setTitle(title);},getBoxy:function(){return this.win;}};Hundsun.Validate={isEmpty:function(str){var returnV;if(!str||jQuery.trim(str)==''){returnV=true;}else{returnV=false;}return returnV;},isInt:function(objStr){var returnV;if(!objStr||objStr==''){returnV=true;}var reg=/(^-?|^\+?)\d+$/;var r=objStr.match(reg);return r!=null;},isDouble:function(objStr){var returnV;if(objStr==""){returnV=true;}var reg=/^[0-9]+[\.[0-9]+]*$/;var r=objStr.match(reg);return r!=null;},isNumber:function(objStr){return Validate.isDouble(objStr)||Validate.isInt(objStr);},isDate:function(str){if(str=="")return true;var re=new RegExp("^([0-9]{4})[-]{1}([0-9]{1,2})[-]{1}([0-9]{1,2})$");var ar;var res=true;if((ar=re.exec(str))!=null){var i;i=parseFloat(ar[2]);if(i<=0||i>12)res=false;i=parseFloat(ar[3]);if(i<=0||i>31)res=false;}else{res=false;}return res;},isEmail:function(str){if(str=="")return true;str=jQuery.trim(str);var reg=/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/;return reg.exec(str)!=null;},isPhone:function(str){if(str==""){return true;}str=jQuery.trim(str);var reg=/^([0-9]{2}-)?(0?[0-9]{2,3}\-)?[1-9]?[0-9]{7}$/;return reg.exec(str)!=null;},isMobile:function(str){if(str==""){return true;}str=jQuery.trim(str);var reg=/^[0-9]{11}/;return reg.exec(str)!=null;},isPostcode:function(str){if(str==""){return true;}str=jQuery.trim(str);var reg=/^[0-9]{6}$/;return reg.exec(str)!=null;},isOrgCode:function(str){if(str==""){return true;}str=jQuery.trim(str);var reg=/^[A-Za-z0-9_\-\[\]\(\)]*$/;return reg.exec(str)!=null;},checkFileType:function(fileName,checkType){var last=fileName.lastIndexOf(".");var lastname=fileName.substring(last,fileName.length);var array=new Array;if(checkType=="1"){array[0]=".jpg";array[1]=".gif";array[2]=".bmp";}else if(checkType=="2"){array[0]=".swf";}else if(checkType=="3"){array[0]=".rm";array[1]=".rmvb";array[2]=".wmv";}for(var i=0;i<array.length;i++){if(lastname.toLowerCase()==array[i])return true;}return false;},checkFileSize:function(file,size){if(file==null||file==''){return false;}var limit=1024*size;var img=new Image();img.dynsrc=file;if(img.fileSize>limit){alert("上传文件的大小不能超过"+size+"K,请更换!");return true;}return false;},fileIsExit:function(fileName){return(fileName.indexOf(':\\')<1)}};Hundsun.UrlUtil={refresh:function(){var url=location.href.toString();location.href=url;},redirect:function(url){location.href=url;},format:function(url,p){if(p){if(url.indexOf("?")==-1){return url+"?"+p;}else{return url+"&"+p;}}else{return url;}},rebuildUrlQuery:function(queryKey,queryValue){var query=document.location.search;if(query!=""){query=query.substring(1);var querys=query.split("&");query="";for(var i=0;i<querys.length;i++){var tmps=querys[i].split("=");if(tmps.length>1){if(tmps[0]!=queryKey){query+="&"+tmps[0]+"="+tmps[1];}}}}query+="&"+queryKey+"="+queryValue;if(query!=""){query=query.substring(1);}return query;},getUrlWithoutQuery:function(){var urlAll=document.location.href;var tmps=urlAll.split("?");return tmps[0];},getParames:function(){var returnO={};var urlAll=document.location.href;var pos=urlAll.indexOf("?");if(pos!=-1){var urlQ=urlAll.substring(pos+1,urlAll.length);var params=urlQ.split('&');var paramsLength=params.length;var param;for(var i=0;i<params.length;i++){param=params[i];var tmp=param.split('=');if(tmp.length==1){returnO[tmp[0]]=null;}else{returnO[tmp[0]]=tmp[1];}}};return returnO;},getUrlQueryFromForm:function(formId){var formItems=jQuery('input[type=text],input[type=hidden],select',jQuery('#'+formId));var query='';jQuery.each(formItems,function(){if(jQuery.trim(this.value)!=''&&jQuery.trim(this.name)!=''){query+='&'+this.name+'='+this.value;}});if(query!=''){query=query.substring(1);}return query;},redirectQueryFromForm:function(url,formId){var url=this.format(url,this.getUrlQueryFromForm(formId));this.redirect(url);return false;}};Hundsun.IdCardUtil={changeToBirth:function(idCart){var idStr="";var birthStr="";if(null!=idCart&&idCart!=''){idStr=idCart.length==18?idCart.substring(0,17):idCart.substring(0,6)+"19"+idCart.substring(6,16);birthStr=idStr.substring(6,10)+"-"+idStr.substring(10,12)+"-"+idStr.substring(12,14);}return birthStr;},changeToArea:function(idCart){var idStr="";var birthStr="";if(null!=idCart&&idCart!=''){birthStr=idCart.substring(0,6);}return birthStr;},changeToSex:function(idCart){var sex="";if(null!=idCart&&idCart!=''){sex=idCart.length==18?idCart.substring(16,17):idCart.substring(14,15);}if(parseInt(sex)%2==1){sex=1;}else{sex=0;}return sex;}};Hundsun.CookieUtil={createCookie:function(name,value,days,Tdom){var Tdom=(Tdom)?Tdom:"/";if(!days){days=30;}var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));document.cookie=name+"="+escape(value)+"; expires="+date.toGMTString()+"; path="+Tdom;},readCookie:function(name){var arr=document.cookie.match(new RegExp("(^| )"+name+"=([^;]*)(;|$)"));return(arr!=null)?unescape(arr[2]):null;}};Hundsun.FormUtils={getFormValues:function(form){var formObj;if(typeof(form)=='string'){formObj=$('#'+form);}else{formObj=form;}var values={};var formItems=formObj.find(':text,textarea,select,:hidden,:password');$.each(formItems,function(){var v=$(this).val();if(v){values[this.name]=v;}});var formCheckBoxs=formObj.find(':checkbox');$.each(formCheckBoxs,function(){if(this.checked){if(values[this.name]){values[this.name]+=','+this.value;}else{values[this.name]=this.value;}}});var formradios=formObj.find(':radio');$.each(formradios,function(){if(this.checked){values[this.name]=this.value;}});return values;},setFormValues:function(formId,values,checkboxNames,radioNames){var formItems=$('#'+formId).find(':text,:hidden,textarea,select');$.each(formItems,function(){var value=_getValue(this.name,values);if(value){$(this).val(value);}});if(checkboxNames&&checkboxNames.length>0){$.each(checkboxNames,function(){var name=this;$('#'+formId).find('[name="'+name+'"]').attr('checked',false);var value=_getValue(name,values);if(value){var checkboxvalues=value.split(',');$.each(checkboxvalues,function(i,o){$('#'+formId).find('[name="'+name+'"][value='+o+']').attr('checked','checked');});}});}if(radioNames&&radioNames.length>0){$.each(radioNames,function(){var name=this;$('#'+formId).find('[name="'+name+'"]').attr('checked',false);var value=_getValue(name,values);if(value){$('#'+formId).find('[name="'+name+'"][value='+value+']').attr('checked','checked');}});}function _getValue(name,values){if(name){var names=name.split('.');var length=names.length;var value=values[names[0]];for(var i=1;i<length;i++){try{value=value[names[i]]}catch(ex){}}return value}else{return null;}}},resetForm:function(formId,isAboutHidden){var formDom=document.getElementById(formId);if(formDom.tagName.toLowerCase()!='form'){var form=$(formDom).find('form');if(form.size()>0){formDom=form.get(0);}else{formDom=null;}}if(formDom){formDom.reset();$('select',$(formDom)).val('');}}};Hundsun.Constant={SUBMIT:'submit',LOAD:'load',MustInputTag:'<font color="red">*</font>'};Date.prototype.format=function(fmt){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S":this.getMilliseconds()};if(/(y+)/.test(fmt)){fmt=fmt.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length));}for(var k in o)if(new RegExp("("+k+")").test(fmt))fmt=fmt.replace(RegExp.$1,(RegExp.$1.length==1)?(o[k]):(("00"+o[k]).substr((""+o[k]).length)));return fmt;};String.format=function(){if(arguments.length==0)return null;var str=arguments[0];for(var i=1;i<arguments.length;i++){var re=new RegExp('\\{'+(i-1)+'\\}','gm');str=str.replace(re,arguments[i]);}return str;};String.prototype.leftPad=function(pads,padChar){var padLength=pads-this.length;if(padLength<=0){return this;}var returnV='';for(var i=0;i<padLength;i++){returnV+=padChar;}returnV+=this;return returnV;};String.prototype.trim=function(){if(!this)return'';return this.replace(/(^\s*)|(\s*$)/g,'');}